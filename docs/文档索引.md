# 网易云音乐评论桌面应用 - 文档索引

**更新日期**: 2025-01-19
**当前版本**: v3.1.0

---

## 📚 文档导航

### 🎯 快速开始

如果你是第一次了解这个项目，建议按以下顺序阅读：

1. **README.md** - 项目简介和快速开始
2. **产品需求文档 (PRD)** - 了解项目要做什么
3. **技术设计文档 (TDD)** - 了解项目怎么做
4. **V2版本完成总结** - 了解核心实现细节
5. **V3版本新功能** - 系统托盘和窗口高度自适应

---

## 📋 核心文档

### 1. 产品需求文档 (PRD)
**路径**: `docs/产品需求文档(PRD).md`

**内容概览**:
- ✅ 产品概述
- ✅ 功能需求（核心功能）
- ✅ 非功能需求（性能、可用性、兼容性）
- ✅ 用户故事
- ✅ 使用场景
- ✅ 验收标准

**适合人群**: 产品经理、项目经理、测试人员

---

### 2. 技术设计文档 (TDD)
**路径**: `docs/技术设计文档(TDD).md`

**内容概览**:
- ✅ 系统架构（4层架构）
- ✅ 模块设计（核心模块）
- ✅ 数据库设计（缓存策略）
- ✅ 接口设计
- ✅ 部署设计
- ✅ 性能优化
- ✅ 安全设计

**适合人群**: 架构师、开发工程师

---

### 3. API 接口文档
**路径**: `docs/API接口文档.md`

**内容概览**:
- ✅ API 概述
- ✅ 核心API接口（搜索、评论、详情）
- ✅ 加密算法实现（AES+RSA）
- ✅ 请求/响应示例
- ✅ 错误处理
- ✅ 测试方法

**适合人群**: 开发工程师、测试工程师

---

### 4. 数据字典
**路径**: `docs/数据字典.md`

**内容概览**:
- ✅ 数据模型（SongInfo、Comment）
- ✅ 缓存结构
- ✅ 配置文件结构
- ✅ 日志格式
- ✅ 数据流转
- ✅ 数据验证

**适合人群**: 开发工程师、DBA（如果将来用数据库）

---

## 🔬 开发总结文档

### 1. 爬虫方案实施总结
**路径**: `discuss/2024-12-31_爬虫方案实施总结.md`

**内容**:
- 爬虫方案完整实施过程
- API接口测试结果
- NeteaseMusicCrawler 类实现
- 完整流程测试验证
- MVP版本功能清单和限制
- V2版本规划（评论接口逆向）

**关键成果**:
- ✅ 成功实施爬虫方案，替代 NeteaseCloudMusicApi
- ✅ 搜索功能: `/api/search/get/web`
- ✅ 详情功能: `/api/song/detail`
- ✅ 无需本地API服务，简化部署

---

### 2. V2版本完成总结
**路径**: `discuss/2025-01-02_V2版本完成总结.md`

**内容**:
- V2版本开发目标
- 核心功能实现（评论接口加密算法、真实评论获取、评论轮播）
- UI优化（窗口尺寸、字体大小、半透明背景）
- 技术栈说明
- 测试验证结果
- 已知限制和后续优化方向

**关键成果**:
- ✅ 实现了AES+RSA加密算法
- ✅ 获取真实热门评论
- ✅ 评论自动轮播（8秒间隔）
- ✅ 半透明背景（60%不透明度）
- ✅ 紧凑的窗口布局（320x200）

---

## 🧪 测试文档

### V2完整功能测试
**路径**: `tests/test_v2_complete.py`

**功能**: 测试V2版本所有核心功能

**测试内容**:
- ✅ 搜索歌曲
- ✅ 获取歌曲详情（风格标签）
- ✅ 获取热门评论
- ✅ 数据解析正确性

**运行方法**:
```bash
python tests/test_v2_complete.py
```

---

## 📂 文件结构

```
music-comment/
├── docs/                           # 核心文档
│   ├── 产品需求文档(PRD).md        # 产品需求
│   ├── 技术设计文档(TDD).md        # 技术设计
│   ├── API接口文档.md              # API文档
│   ├── 数据字典.md                 # 数据字典
│   └── 文档索引.md                 # 本文档
│
├── discuss/                        # 调研文档
│   ├── 2024-12-31_爬虫方案实施总结.md    # 爬虫方案
│   └── 2025-01-02_V2版本完成总结.md     # V2版本总结
│
├── tests/                          # 测试脚本
│   └── test_v2_complete.py         # V2完整功能测试
│
├── src/                            # 源代码
│   ├── config/                     # 配置管理
│   │   └── settings.py
│   ├── core/                       # 核心逻辑
│   │   ├── monitor.py              # 窗口标题读取
│   │   ├── netease_crawler.py      # 网易云爬虫
│   │   └── crypto.py               # 加密算法（AES+RSA）
│   ├── gui/                        # 图形界面
│   │   ├── main_window.py          # 主窗口
│   │   └── comment_widget.py       # 评论展示组件
│   ├── models/                     # 数据模型
│   │   ├── song_info.py
│   │   └── comment.py
│   ├── utils/                      # 工具函数
│   │   └── logger.py
│   └── main.py                     # 应用入口
│
├── scripts/                        # 启动脚本
│   └── run.bat                     # 批处理脚本
│
├── .venv/                          # Python虚拟环境
├── logs/                           # 日志输出
├── requirements.txt                # 依赖清单
└── README.md                       # 项目说明
```

---

## 📖 文档阅读指南

### 按角色阅读

**项目经理**:
1. README.md
2. 产品需求文档 (PRD)
3. V2版本完成总结

**架构师/技术负责人**:
1. 技术设计文档 (TDD)
2. API接口文档
3. 数据字典
4. V2版本完成总结

**开发工程师**:
1. 技术设计文档 (TDD)
2. API接口文档
3. 数据字典
4. V2版本完成总结

**测试工程师**:
1. 产品需求文档 (PRD)
2. API接口文档
3. 测试脚本

---

## 🔄 文档更新记录

| 日期 | 文档 | 版本 | 更新内容 |
|------|------|------|----------|
| 2024-12-30 | 产品需求文档 (PRD) | v1.0 | 初始创建 |
| 2024-12-30 | 技术设计文档 (TDD) | v1.0 | 初始创建 |
| 2024-12-30 | API接口文档 | v1.0 | 初始创建 |
| 2024-12-30 | 数据字典 | v1.0 | 初始创建 |
| 2024-12-30 | 文档索引 | v1.0 | 初始创建 |
| 2024-12-31 | 爬虫方案实施总结 | v1.0 | 爬虫方案完整实施过程 |
| 2025-01-02 | 产品需求文档 (PRD) | v2.0 | 更新 - 反映V2版本实现状态 |
| 2025-01-02 | 技术设计文档 (TDD) | v2.0 | 更新 - 添加加密算法模块 |
| 2025-01-02 | API接口文档 | v2.0 | 更新 - 添加评论接口加密实现 |
| 2025-01-02 | 数据字典 | v2.0 | 更新 - 更新数据模型说明 |
| 2025-01-02 | 文档索引 | v2.0 | 更新 - 反映V2版本文件结构 |
| 2025-01-02 | V2版本完成总结 | v1.0 | 新增 - V2版本开发总结 |
| 2025-01-06 | **README.md** | v3.0 | **更新** - 添加V3新功能说明 |
| 2025-01-06 | **产品需求文档 (PRD)** | v3.0 | **更新** - 添加系统托盘和窗口高度自适应 |
| 2025-01-06 | **技术设计文档 (TDD)** | v3.0 | **更新** - 添加系统托盘模块和高度自适应机制 |
| 2025-01-06 | **文档索引** | v3.0 | **更新** - 反映V3版本更新 |
| 2025-01-19 | **产品需求文档 (PRD)** | v3.1 | **更新** - 添加全局快捷键功能 |
| 2025-01-19 | **技术设计文档 (TDD)** | v3.1 | **更新** - 添加全局快捷键实现说明 |
| 2025-01-19 | **文档索引** | v3.1 | **更新** - 反映V3.1版本更新 |

---

## 💡 常见问题

### Q1: 核心技术方案是什么？
**A**: 窗口标题读取方案。通过 `win32gui` 读取网易云窗口标题，解析出歌曲名和歌手名，再通过 API 搜索获取 song_id 和评论。

### Q2: 项目使用什么技术栈？
**A**: Python 3.10+ + PyQt6 + pywin32 + psutil + requests + pycryptodome

**详见**: [技术设计文档](docs/技术设计文档(TDD).md) 第1章

### Q3: 数据如何存储？
**A**: 内存缓存（LRU Cache）+ 文件存储（配置文件）

**详见**: [数据字典](docs/数据字典.md) 第1章

### Q4: 如何获取歌曲数据？
**A**: 直接调用网易云 Web API，使用自行实现的加密算法。本项目实现了评论接口的AES+RSA加密算法。

**详见**: [API接口文档](docs/API接口文档.md)
**详见**: [V2版本完成总结](discuss/2025-01-02_V2版本完成总结.md)

### Q5: 最小化时能正常工作吗？
**A**: 能！窗口标题读取方案在窗口最小化时仍然有效。

### Q6: 评论功能如何实现的？
**A**: V2版本实现了网易云评论接口的加密算法（AES-CBC + RSA），成功获取真实热门评论。

**详见**: [V2版本完成总结](discuss/2025-01-02_V2版本完成总结.md) 第2.1节

### Q7: 评论轮播功能如何工作？
**A**: 使用 QTimer 每8秒自动切换到下一条评论，循环显示所有获取到的热门评论。

**详见**: [V2版本完成总结](discuss/2025-01-02_V2版本完成总结.md) 第2.3节

### Q8: 半透明背景如何实现？
**A**: 使用 PyQt6 的 WA_TranslucentBackground 属性，配合自定义绘制实现真正的半透明效果（60%不透明度）。

**详见**: [V2版本完成总结](discuss/2025-01-02_V2版本完成总结.md) 第2.4节

### Q9: V2版本有哪些功能？
**A**:
1. ✅ 自动识别歌曲（窗口标题读取）
2. ✅ 真实热门评论获取（实现了加密算法）
3. ✅ 评论自动轮播（8秒间隔）
4. ✅ 半透明悬浮窗口（60%不透明度）
5. ✅ 可拖动、可最小化
6. ✅ 自动更新（每3秒检测歌曲切换）

---

## 🔗 相关资源

### 技术资源
- [PyQt6 官方文档](https://www.riverbankcomputing.com/static/Docs/PyQt6/)
- [pycryptodome 文档](https://www.pycryptodome.org/)
- [Python Windows API 文档](https://docs.python.org/3/library/windows.html)

### 参考文章
- [Python爬虫练习：爬取网易云音乐评论(2024附完整代码)](https://blog.csdn.net/Lywan666/article/details/136632883)
- [网易云音乐搜索接口JS逆向：Params、encSecKey加密和AES](https://developer.aliyun.com/article/1596740)

### 参考项目
- [使用Python获取网易云正在播放的音乐](https://egg.moe/2020/07/get-netease-cloudmusic-playing/)
- [真·网易云实时获取当前播放歌曲名](https://bbs.ijingyi.com/forum.php?mod=viewthread&tid=14863355)

---

## 📮 联系方式

- **问题反馈**: GitHub Issues
- **功能建议**: GitHub Discussions

---

**文档结束**

最后更新：2025-01-02
